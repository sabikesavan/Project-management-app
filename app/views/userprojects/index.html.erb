<% @userprojects.each do |userproject| %>
  <%if userproject.role =='Admin' || userproject.role =='Project manager' || userproject.role =='Team lead' %>
    <%= link_to 'New Userproject', new_userproject_path(id: userproject.id) %><br><br>
  <% end -%>
  <%= link_to 'Assign task to user', new_task_path(id: userproject.id) %><br><br>
  <%= link_to 'Assigned Task', tasks_path(id: userproject.id) %><br><br>
  <%= link_to 'Comments', comments_path(id: userproject.id) %><br><br>

  <%= form_tag(search_path, :method => "get") do %>
    Task : <%= search_field_tag :search, params[:search], placeholder: "Search" %><br>
    <%= hidden_field :project_id, params[:project_id], :value => userproject.project_id %>
    <br>User Id : <%= search_field_tag :user_id, params[:user_id], placeholder: "Search" %>
    <%= button_tag "search" %>
  <% end %>

  <table>
    <tbody>
      <% if userproject.role == 'Admin' %>
        <tr>
          <td><h4>Project manager :</h4></td>
          <% Userproject.all.each do |u| %>
            <% if u.role == 'Project manager' && u.project_id == userproject.project_id %>
            <tr>
              <td>User Id : <%= u.user_id %></td>
              <td><%= link_to 'Task', tasks_path(id: u.id) %>
              <td><%= link_to 'Destroy', u, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
            <% end -%>
          <% end -%>
        </tr>
        <tr>
          <td><h4>Team lead :</h4></td>
          <% Userproject.all.each do |u| %>
            <% if u.role == 'Team lead' && u.project_id == userproject.project_id %>
            <tr>
              <td>User Id : <%= u.user_id %></td>
              <td><%= link_to 'Task', tasks_path(id: u.id) %>
              <td><%= link_to 'Destroy', u, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
            <% end -%>
          <% end -%>
        </tr>
        <tr>
          <td><h4>Developer :</h4></td>
          <% Userproject.all.each do |u| %>
            <% if u.role == 'Developer' && u.project_id == userproject.project_id %>
            <tr>
              <td>User Id : <%= u.user_id %></td>
              <td><%= link_to 'Task', tasks_path(id: u.id) %>
              <td><%= link_to 'Destroy', u, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
            <% end -%>
          <% end -%>
        </tr>

        <% elsif userproject.role == 'Project manager' %>
        <tr>
          <td><h4>Team lead :</h4></td>
          <% Userproject.all.each do |u| %>
            <% if u.role == 'Team lead' && u.project_id == userproject.project_id %>
            <tr>
              <td>User Id : <%= u.user_id %></td>
              <td><%= link_to 'Task', tasks_path(id: u.id) %>
              <td><%= link_to 'Destroy', u, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
            <% end -%>
          <% end -%>
        </tr>
        <tr>
          <td><h4>Developer :</h4></td>
          <% Userproject.all.each do |u| %>
            <% if u.role == 'Developer' && u.project_id == userproject.project_id %>
            <tr>
              <td>User Id : <%= u.user_id %></td>
              <td><%= link_to 'Task', tasks_path(id: u.id) %>
              <td><%= link_to 'Destroy', u, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
            <% end -%>
          <% end -%>
        </tr>

        <% elsif userproject.role == 'Team lead' %>
        <tr>
          <td><h4>Developer :</h4></td>
          <% Userproject.all.each do |u| %>
            <% if u.role == 'Developer' && u.project_id == userproject.project_id %>
            <tr>
              <td>User Id : <%= u.user_id %></td>
              <td><%= link_to 'Task', tasks_path(id: u.id) %>
              <td><%= link_to 'Destroy', u, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
            <% end -%>
          <% end -%>
        </tr>

        <% elsif userproject.role == 'Developer' %>
          <br>User Id : <%= userproject.user_id %>
      <% end -%>
    </tbody>
  </table>
<% end -%>
<%= link_to 'Back', projects_path %>
